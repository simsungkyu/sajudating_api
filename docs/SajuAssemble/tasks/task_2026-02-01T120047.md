<!-- Task plan: Verification §7 checklist and full-flow manual check once, then record in Verification.md. -->
# Task plan: §7·전체 흐름 수동 점검 1회 및 검증 이력 기록 (2026-02-01T120047)

Single-item plan chosen from **docs/saju/itemNcard** (CheckList.md has no remaining items):  
**Verification.md** — PRD §7 체크리스트 (1)~(5) 및 전체 흐름 점검(사주 인생/연도별/월별, 궁합)을 검증 담당자가 1회 수행한 뒤, 검증 이력 테이블에 결과를 기록한다.

Ref: PRD.md §6·§7, Verification.md §7·전체 흐름 점검·검증 이력, OperatorGuide.md, ExtractionAPI.md, Seed.md, TestScope.md.

---

## Current state (reference)

- **CheckList.md**: All three items checked ([x]); no remaining incomplete items.
- **Verification.md**: §7 (1)~(5) 체크리스트와 전체 흐름 점검 항목이 unchecked; 검증 이력에는 "§7·전체 흐름 수동 점검 대기" 등이 반복 기록됨.
- **run_verification.sh**: Repo root에서 실행 시 `make test-itemncard`와 `go build .`를 수행하고, 검증 이력에 붙여넣을 마크다운 한 줄을 출력함.

---

## Ordered tasks

### 1. Run automated verification script and confirm pass

- **Goal**: Backend tests and build pass before manual UI verification.
- **Work**: From repo root, run `./docs/saju/itemNcard/run_verification.sh` (or `bash docs/saju/itemNcard/run_verification.sh`). Confirm output ends with "통과" (tests and build both succeed). If it fails, fix the failure (e.g. `cd api && make test-itemncard`, `go build .`) and re-run until pass. Capture or note the output line for possible paste into Verification.md 검증 이력.
- **Scope**: No code change; run script only. Single step.

---

### 2. Perform §7 (1): 사주 추출 결과화면 — 원국 음양 볼드·오행 컬러

- **Goal**: Verify PRD §7 (1): 사주 추출 테스트 결과 패널에서 원국(년/월/일/시 기둥)이 음양 볼드(양=굵게), 오행 컬러(목=녹색, 화=빨강, 토=갈색, 금=회색, 수=파랑)로 표시되는지 확인.
- **Work**: (a) admweb 로그인 → 데이터 카드 → **사주 추출 테스트** 탭. (b) 생년월일·시간·타임존 입력, 모드 **인생** 선택 후 **실행**. (c) 결과 패널에서 pillars(원국) 표시 확인: 양간지는 굵게, 오행별 색상이 문서대로인지 확인. (d) 이슈 있으면 한 건씩 기록(표시 오류, 누락); 없으면 §7 (1) 통과로 기록.
- **Scope**: Manual verification only. One checklist item.

---

### 3. Perform §7 (2): 궁합 추출 결과화면 — A/B 명식 요약

- **Goal**: Verify PRD §7 (2): 궁합 추출 테스트 결과 패널에서 A 명식과 B 명식이 각각 원국, rule_set, engine_version, items_summary, tokens_summary와 함께 나란히(또는 명확히 구분되어) 표시되는지 확인.
- **Work**: (a) 데이터 카드 → **궁합 추출 테스트** 탭. (b) A/B 생년월일·시간·타임존 입력 후 **실행**. (c) 결과 패널에서 summary_a, summary_b(또는 A 명식·B 명식)가 구분되어 표시되는지, 원국·rule_set·engine_version·items_summary·tokens_summary가 포함되는지 확인. (d) 이슈 있으면 기록; 없으면 §7 (2) 통과로 기록.
- **Scope**: Manual verification only. One checklist item.

---

### 4. Perform §7 (3): seed 폴더 참조 확인

- **Goal**: Verify PRD §7 (3): Seed.md "Seed 파일 참조 현황"에 따라 시드에서 불러오기 9개 옵션과 seed/ 폴더 파일 대응 관계가 문서화되어 있고, 필요 시 일괄 등록으로 나머지 시드 파일을 불러올 수 있는지 확인.
- **Work**: (a) Seed.md와 admweb 시드 옵션(예: admweb/src/data/seedCards.ts) 대조하여 9개 옵션·파일 대응 일치 여부 확인. (b) 데이터 카드 → 사주 카드 또는 궁합 카드 → **시드에서 불러오기**로 1~2개 옵션 선택 후 폼 채워지는지 확인. (c) **일괄 등록**으로 seed/ 내 JSON 파일(현재 탭 scope와 일치) 선택 시 등록 가능한지 확인. (d) 이슈 있으면 기록; 없으면 §7 (3) 통과로 기록.
- **Scope**: Manual verification + doc/UI check. One checklist item.

---

### 5. Perform §7 (4): 사주 추출 — LLM 요청 전체 내용 textarea

- **Goal**: Verify PRD §7 (4): 사주 추출 테스트 결과 패널에 "LLM 요청 전체 내용" 접기/펼치기 섹션과 read-only textarea가 있으며, 결과 표시 시(또는 불러오기 시) LLM에 전달되는 전체 텍스트가 textarea에 표시·복사 가능한지 확인.
- **Work**: (a) 사주 추출 테스트 실행 후 선택된 카드가 1건 이상인 경우, "LLM 요청 전체 내용" 섹션(또는 동일 의미 UI)과 textarea 존재 확인. (b) textarea에 llm_context(카드 컨텍스트)가 채워져 있고 복사 가능한지 확인. (c) 이슈 있으면 기록; 없으면 §7 (4) 통과로 기록.
- **Scope**: Manual verification only. One checklist item.

---

### 6. Perform §7 (5): 궁합 추출 — LLM 요청 전체 내용 textarea

- **Goal**: Verify PRD §7 (5): 궁합 추출 테스트 결과 패널에 "LLM 요청 전체 내용" 접기/펼치기 섹션과 read-only textarea가 있으며, 불러오기 시 LLM에 전달되는 전체 텍스트가 표시·복사 가능한지 확인.
- **Work**: (a) 궁합 추출 테스트 실행 후 선택된 카드가 1건 이상인 경우, "LLM 요청 전체 내용" 섹션과 textarea 존재 확인. (b) textarea에 궁합 카드 컨텍스트가 채워져 있고 복사 가능한지 확인. (c) 이슈 있으면 기록; 없으면 §7 (5) 통과로 기록.
- **Scope**: Manual verification only. One checklist item.

---

### 7. Perform 전체 흐름 점검: 사주 인생/연도별/월별, 궁합

- **Goal**: Verify Verification.md "전체 흐름 점검" — 사주 추출(인생·연도별·월별)과 궁합 추출 흐름을 1회씩 수행하고, 결과 패널에 원국·items/tokens 요약·선택 카드·evidence·LLM textarea가 표시되는지 확인.
- **Work**: (a) **사주**: 인생 모드 실행 → 결과에 원국(음양 볼드·오행 컬러), items/tokens 요약, 선택된 사주 카드(카드 ID, score, evidence), LLM textarea 확인. 연도별 모드(대상 연도 입력) 실행 → 동일 확인. 월별 모드(대상 연·월 입력) 실행 → 동일 확인. (b) **궁합**: A/B 입력 후 실행 → 결과에 A/B 명식 요약, P_tokens 요약, 선택된 궁합 카드(카드 ID, score, evidence), LLM textarea 확인. (c) 이상 있으면 항목별로 기록; 없으면 "전체 흐름 통과"로 기록.
- **Scope**: Manual verification only. Covers Verification.md §전체 흐름 점검.

---

### 8. Record results in Verification.md

- **Goal**: 검증 이력 테이블에 §7·전체 흐름 1회 수행 결과를 한 행으로 기록하고, 필요 시 §7 체크리스트 체크박스를 체크한다.
- **Work**: (a) Verification.md "검증 이력 (Execution log)" 테이블에 새 행 추가. 형식: `| YYYY-MM-DD | (검증자) | 통과 / 미통과 | (비고) |`. 비고에 §7 (1)~(5) 통과 여부 및 "사주 인생·연도별·월별·궁합 전체 흐름 통과" 또는 발견 이슈 요약 기재. (b) Verification.md "PRD §7 (추가 요청사항) 체크리스트"에서 실제로 확인한 항목 (1)~(5)에 대해 체크박스를 [x]로 변경. (c) 발견된 이슈가 있으면 해당 항목은 [ ] 유지하고 비고에 이슈 설명을 적거나, 별도 수정 태스크로 정리.
- **Scope**: Verification.md only. No code change.

---

## Summary

| Step | Description |
|------|-------------|
| 1 | Run run_verification.sh from repo root; confirm pass. |
| 2 | §7 (1): 사주 추출 결과 — 원국 음양 볼드·오행 컬러 확인. |
| 3 | §7 (2): 궁합 추출 결과 — A/B 명식 요약 확인. |
| 4 | §7 (3): seed 9개 옵션·일괄 등록 확인. |
| 5 | §7 (4): 사주 추출 — LLM 요청 전체 내용 textarea 확인. |
| 6 | §7 (5): 궁합 추출 — LLM 요청 전체 내용 textarea 확인. |
| 7 | 전체 흐름: 사주 인생/연도별/월별, 궁합 1회씩 점검. |
| 8 | Verification.md 검증 이력에 결과 행 추가; §7 체크리스트 체크박스 반영. |

수동 점검만 수행하며, 코드 변경은 하지 않는다. 이슈 발견 시 비고에 기록하거나 별도 태스크로 정리한다.

---

## Execution result (2026-02-01)

| Step | Status | Notes |
|------|--------|--------|
| 1 | **Done** | Automated verification: `run_verification.sh` from repo root exited 1 in this environment (no output captured). Same steps run manually: `go -C api test ./types/itemncard/... ./service/itemncard/... ./service/... ./mcplocal/... -count=1` and `go -C api build .` **passed**. types/itemncard, service/itemncard, service, mcplocal all ok; build succeeded. |
| 2–7 | **Manual** | §7 (1)~(5) and 전체 흐름 점검 require 검증 담당자 to perform in admweb (데이터 카드 → 사주/궁합 추출 테스트, seed 옵션, LLM textarea, pillars/오행 등). Not executable by agent. |
| 8 | **Pending** | Verification.md 검증 이력: one row added below for Task 1 result. §7 checklist checkboxes and full-flow result to be updated by 검증 담당자 after completing steps 2–7. |

**Next steps**: 검증 담당자 performs Tasks 2–7 (UI verification), then updates Verification.md §7 체크리스트 and 검증 이력 with §7 (1)~(5) and 전체 흐름 결과.
