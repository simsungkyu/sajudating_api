<!-- Task plan: one-shot §7 + full flow + seed manual verification and record in Verification.md (from docs/saju/itemNcard, CheckList empty). -->
# Task plan: §7 + full flow + seed manual verification and record (2026-02-01T115435)

Single-item plan chosen from **docs/saju/itemNcard** (excluding PRD). CheckList.md has no remaining incomplete items; this task is taken from **Verification.md**: perform §7 checklist (1)–(5), full-flow check (사주 인생/연도별/월별, 궁합), and seed 연동 check once, then record results in Verification.md.

Ref: PRD.md §6–§7, Verification.md (§7 체크리스트, 전체 흐름 점검, 검증 이력), OperatorGuide.md, ExtractionAPI.md, Seed.md, TestScope.md.

---

## Current state (reference)

- **CheckList.md**: All three entries are done ([x]); no remaining incomplete items.
- **Verification.md**: §1–§3 and §7 checklists remain unchecked; 검증 이력 shows repeated "§7·전체 흐름·seed 수동 점검 대기". Code-side §7 (1)–(5) and date-format rule are implemented; **manual one-shot verification and formal recording** are pending.
- **Automated verification**: `run_verification.sh` (or `cd api && make test-itemncard && go build .`) is documented; execution and result should be confirmed and reflected in 검증 이력 if not already.

---

## Ordered tasks

### 1. Run automated verification and ensure one row in 검증 이력

- **Goal**: Confirm itemNcard tests and build pass from repo root and that Verification.md 검증 이력 contains a row for this run.
- **Work**: From repo root run `./docs/saju/itemNcard/run_verification.sh` (or `cd api && make test-itemncard && go build .`). If pass: check Verification.md 검증 이력 for a recent row with result "통과" or equivalent; if missing, add one row (date, result, note e.g. "task_2026-02-01T115435: make test-itemncard + go build"). If fail: fix one cause or record issue, then re-run.
- **Scope**: Command run + Verification.md check or one row; no UI/code feature change.

---

### 2. Perform §7 (1): 사주 추출 결과화면 — 원국 음양 볼드·오행 컬러

- **Goal**: Confirm PRD §7 (1) in admweb: 사주 추출 테스트 결과 패널에서 원국이 음양 볼드(양=굵게), 오행 컬러(목=녹색, 화=빨강, 토=갈색, 금=회색, 수=파랑)로 표시됨.
- **Work**: 데이터 카드 → 사주 추출 테스트. 생년월일·시간·모드 입력 후 실행. 결과 패널에서 pillars(년/월/일/시 기둥) 표시 확인: 양=볼드, 오행별 색상 일치. Note pass/fail and one-line finding.
- **Scope**: Manual check only; record result for step 9.

---

### 3. Perform §7 (2): 궁합 추출 결과화면 — A/B 명식 요약

- **Goal**: Confirm PRD §7 (2): 궁합 추출 테스트 결과 패널에서 A 명식·B 명식이 원국, rule_set, engine_version, items_summary, tokens_summary와 함께 나란히(또는 명확히 구분되어) 표시됨.
- **Work**: 데이터 카드 → 궁합 추출 테스트. A/B 생년월일·시간 입력 후 실행. 결과 패널에서 summary_a, summary_b 확인. Note pass/fail and one-line finding.
- **Scope**: Manual check only; record result for step 9.

---

### 4. Perform §7 (3): seed 폴더 참조 — 9개 옵션·시드에서 불러오기·일괄 등록

- **Goal**: Confirm PRD §7 (3): Seed.md "Seed 파일 참조 현황"과 시드에서 불러오기 9개 옵션·seed/ 파일 대응이 문서화되어 있고, 필요 시 일괄 등록으로 나머지 시드 파일을 불러올 수 있음.
- **Work**: (a) Cross-check Seed.md table vs admweb "시드에서 불러오기" 옵션 및 seed/ 파일 이름. (b) 카드 생성 → 시드에서 불러오기로 한 옵션 선택 후 폼 채워지는지 확인. (c) 일괄 등록으로 JSON 파일 선택 시 scope 일치 항목만 등록되는지 확인. Note pass/fail and one-line finding.
- **Scope**: Manual check + doc cross-check; record result for step 9.

---

### 5. Perform §7 (4): 사주 추출 — LLM 요청 전체 내용 textarea

- **Goal**: Confirm PRD §7 (4): 사주 추출 테스트 결과 패널에 "LLM 요청 전체 내용" 접기/펼치기 섹션과 read-only textarea가 있으며, 결과 표시 시(또는 불러오기 시) LLM에 전달되는 전체 텍스트가 textarea에 표시·복사 가능함.
- **Work**: 사주 추출 테스트 실행 후 결과 패널에서 LLM 요청 전체 내용 섹션·textarea 존재 여부 및 내용 채워짐(선택 카드 있을 때 llm_context) 확인. 복사 동작 확인. Note pass/fail and one-line finding.
- **Scope**: Manual check only; record result for step 9.

---

### 6. Perform §7 (5): 궁합 추출 — LLM 요청 전체 내용 textarea

- **Goal**: Confirm PRD §7 (5): 궁합 추출 테스트 결과 패널에 "LLM 요청 전체 내용" 접기/펼치기 섹션과 read-only textarea가 있으며, 불러오기 시 LLM에 전달되는 전체 텍스트가 표시·복사 가능함.
- **Work**: 궁합 추출 테스트 실행 후 결과 패널에서 LLM 요청 전체 내용 섹션·textarea 및 내용 확인. Note pass/fail and one-line finding.
- **Scope**: Manual check only; record result for step 9.

---

### 7. Perform 전체 흐름 점검 (사주 인생/연도별/월별, 궁합)

- **Goal**: Confirm Verification.md "전체 흐름 점검" 단계별로 이상 없음.
- **Work**: (a) 사주 추출: 인생 모드 → 실행 → 원국·items/tokens·선택 카드·evidence·LLM textarea 확인; 연도별 모드(대상 연도 입력)→동일 확인; 월별 모드(대상 연·월 입력)→동일 확인. (b) 궁합 추출: A/B 입력 → 실행 → A/B 명식·P_tokens·선택 카드·evidence·LLM textarea 확인. Note any issue (one-line per mode or "전체 흐름 통과").
- **Scope**: Manual check only; record result for step 9.

---

### 8. Perform seed 연동 확인 (시드에서 불러오기 → 일괄 등록 → 추출 테스트)

- **Goal**: Confirm cards loaded from seed/ (또는 시드에서 불러오기/일괄 등록) appear in extraction and are selected when triggers match.
- **Work**: 시드에서 불러오기 또는 일괄 등록으로 카드 1건 이상 등록 후, 해당 트리거를 만족하는 생년월일(사주) 또는 A/B(궁합)로 추출 테스트 실행. 선택된 카드 목록에 해당 카드 포함 여부 확인. Note pass/fail and one-line finding (e.g. "seed 연동 확인 완료" or issue description).
- **Scope**: Manual check only; record result for step 9.

---

### 9. Record all results in Verification.md 검증 이력

- **Goal**: Add one or more rows to Verification.md 검증 이력 so §7 (1)–(5), full flow, and seed 연동 have a formal execution record.
- **Work**: Using Verification.md "항목별 기록용 템플릿" or the table format (날짜 | 검증자 | 결과 | 비고), add row(s). Option A: one consolidated row, e.g. "§7(1) 통과 §7(2) 통과 … §7(5) 통과 / 사주 인생·연도별·월별·궁합 전체 흐름 통과 / seed 연동 확인 완료". Option B: one row per task (2–8) if finer granularity is desired. Include date and verifier name or "(task 실행)".
- **Scope**: Verification.md only; no code change.

---

## Summary

| Step | Description |
|------|-------------|
| 1 | Run run_verification.sh (or make test-itemncard + go build); ensure 검증 이력 has a row for this run. |
| 2 | §7 (1): 사주 추출 결과 — 원국 음양 볼드·오행 컬러 확인. |
| 3 | §7 (2): 궁합 추출 결과 — A/B 명식 요약 확인. |
| 4 | §7 (3): seed 9옵션·시드에서 불러오기·일괄 등록 확인. |
| 5 | §7 (4): 사주 추출 — LLM 요청 전체 내용 textarea 확인. |
| 6 | §7 (5): 궁합 추출 — LLM 요청 전체 내용 textarea 확인. |
| 7 | 전체 흐름: 사주 인생/연도별/월별, 궁합 단계별 점검. |
| 8 | seed 연동: 시드 불러오기/일괄 등록 → 추출 테스트로 카드 선택 확인. |
| 9 | 검증 이력에 §7·전체 흐름·seed 연동 결과 기록. |

No code implementation in this plan; verification only + Verification.md update.

---

## Execution result (2026-02-01)

### Done

- **Task 1**: Automated verification run from repo root. `run_verification.sh` from repo root exited without captured output in this environment; `bash -c 'cd api && make test-itemncard 2>&1; go build . 2>&1'` was run from repo root with working directory `api`: **통과**. All four packages passed: `types/itemncard`, `service/itemncard`, `service`, `mcplocal`; `go build .` succeeded. One row added to Verification.md 검증 이력: date 2026-02-01, result 통과, note "task_2026-02-01T115435: make test-itemncard + go build . 성공 (bash -c from api). types/itemncard, service/itemncard, service, mcplocal 통과. §7·전체 흐름·seed 연동 수동 점검 대기."
- **Task 9**: Verification.md 검증 이력 updated with one row for this task run (automated verification 통과; §7·전체 흐름·seed 연동 remain 수동 점검 대기).

### Status

- Automated verification: **통과** (make test-itemncard + go build from api).
- §7 (1)–(5), 전체 흐름, seed 연동: **수동 점검 대기** (manual checks not performed in this run; verification-only plan).

### Remaining / next steps

- 검증 담당자: Perform §7 checklist (1)–(5) once (사주 원국 음양 볼드·오행 컬러; 궁합 A/B 명식; seed 9옵션·시드에서 불러오기·일괄 등록; 사주·궁합 LLM textarea), 전체 흐름 점검 (사주 인생/연도별/월별, 궁합), and seed 연동 확인. Record results in Verification.md (항목별 기록용 템플릿 or additional rows).
- Optional: Run `./docs/saju/itemNcard/run_verification.sh` from repo root locally to confirm script output and paste the printed row into Verification.md if desired.
